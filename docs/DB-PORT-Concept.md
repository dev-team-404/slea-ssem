Backend가 WSL-DB(5432) vs Docker-DB(5433)를 사용할지는 어디서 설정하나요?

답: 실행 방식에 따라 다릅니다 ⚙️

┌─────────────────────────────────────────────────────────────┐
│                   데이터베이스 연결 경로                      │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  실행 방식 1: docker-compose up                              │
│  ───────────────────────────────────────                    │
│  설정 파일: docker-compose.yml (line 76)                    │
│  DATABASE_URL: postgresql://...@db:5432/...                │
│  'db' = Docker 컨테이너 네트워크 내부 이름                   │
│  포트: 5432 (Docker 컨테이너 내부)                          │
│  ✅ Backend가 Docker PostgreSQL 사용                        │
│                                                              │
│  ───────────────────────────────────────                    │
│                                                              │
│  실행 방식 2: ./tools/dev.sh up                              │
│  ───────────────────────────────────                        │
│  설정 파일: .env (line 12)                                  │
│  DATABASE_URL: postgresql://...@localhost:5432/...          │
│  'localhost' = WSL 호스트 머신                              │
│  포트: 5432 (WSL PostgreSQL)                                │
│  ✅ Backend가 WSL PostgreSQL 사용                           │
│                                                              │
└─────────────────────────────────────────────────────────────┘

핵심 개념:

Docker 컨테이너 네트워크 vs 호스트 네트워크

┌─────────────────────────────────────────────────────┐
│                    WSL Host                         │
│                                                     │
│  PostgreSQL (5432) ← WSL 로컬 DB                   │
│                                                     │
│  ┌──────────────────────────────────────────────┐  │
│  │  Docker Container (backend)                  │  │
│  │                                              │  │
│  │  DATABASE_URL: @db:5432                      │  │
│  │  (Docker 내부 네트워크, 포트 매핑 무관)      │  │
│  │        ↓                                      │  │
│  │  PostgreSQL 컨테이너 (5432)  ← Docker DB    │  │
│  │                                              │  │
│  └──────────────────────────────────────────────┘  │
│        ↑                                           │
│        Port 5433 (호스트 → 컨테이너 매핑)         │
│                                                     │
│  VSCode (localhost:5433)                          │
│  └─ WSL 호스트에서 Docker DB 접속               │
│                                                     │
└─────────────────────────────────────────────────────┘

---
📊 설정 요약 테이블

| 구성요소         | 파일                    | 설정값             | 설명                       |
|--------------|-----------------------|-----------------|--------------------------|
| Docker 내부 DB | docker-compose.yml:76 | @db:5432        | Backend → Docker DB (내부) |
| Docker 외부 DB | docker-compose.yml:31 | 5433:5432       | 호스트 5433 → Docker 5432   |
| WSL 로컬 DB    | .env:12               | @localhost:5432 | Backend → WSL DB (로컬)    |
| 인증 방식        | docker-compose.yml:21 | trust           | Password 불필요 (개발용)       |

---